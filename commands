#ap up
rm /var/run/hostapd/ap0
iw phy phy0 interface add ap0 type __ap
ifconfig ap0 up 192.168.100.1
hostapd -B /etc/hostapd/hostapd.conf
dnsmasq

#ap down
ifconfig ap0 down
iw dev ap0 del
killall hostapd dnsmasq

#wlan up
wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf
  ctrl_iface exists and seems to be in use - cannot override it
  Delete '/var/run/wpa_supplicant/wlan0' manually if it is not used anymore
  Failed to initialize control interface 'DIR=/var/run/wpa_supplicant GROUP=netdev'.
  You may have another wpa_supplicant process already running or the file was
  left by an unclean termination of wpa_supplicant in which case you will need
  to manually remove this file before starting wpa_supplicant again.
dhclient wlan0

#wlan down
ifconfig wlan0 down
wpa_cli terminate
dhclient -r

#scan for ssids
wpa_cli scan_results | grep WPA | grep -v \x | awk '{print $NF}' | grep -v ]$
iw wlan0 scan | egrep 'SSID: \w' | awk '{print $2}'

#configure wpa file